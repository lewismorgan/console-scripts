#!/usr/bin/env bash

# Wrapper script to install everything through YADM
# Created by Lewis Morgan

system_type=$(uname -s)

mac_install() {
  for file in $HOME/.yadm/bin/mac/*; do
    ln -s ${file} $HOME/bin/${file##*/}
  done

  # Dev tools
  xcode-select --install
  
  # Homebrew
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
  brew install yadm
  # Setup of packages is done during bootstrap
}

linux_install() {
  for file in $HOME/.yadm/bin/linux/*; do
    ln -s $HOME/bin/${file##*/} ${file}
  done
}

# Create a bin folder for user scripts
if [ ! -d "$HOME/bin" ]; then
  mkdir $HOME/bin
fi

for file in $HOME/.yadm/bin/all/*; do
  ln -s ${file} $HOME/bin/${file##*/}
done

# Clone the dotfiles
yadm clone https://github.com/lewismorgan/dotfiles.git --no-bootstrap
yadm bootstrap

# Change the shell to ZSH --- Keep this as the last line otherwise nothing will run after.
chsh -s $(grep /zsh$ /etc/shells | tail -1)